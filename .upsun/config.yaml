# Upsun configuration, generated using AI at: 2025-12-01T00:39:34Z
# AI can make mistakes. Please modify this file to suit your needs.
applications:
  backend:
    type: nodejs:24
    build:
      flavor: none
    hooks:
      build: |
        set -ex
        npm install --omit=dev
    web:
      commands:
        start: npm start
      locations:
        /:
          root: public
          passthru: true
          allow: false
        '^/(api|health|exercises)':
          passthru: true

  frontend:
    type: nodejs:24
    source:
      root: frontend
    build:
      flavor: none
    hooks:
      build: |
        set -ex
        npm install --omit=dev
        npm run build
    web:
      commands:
        start: sleep infinity
      locations:
        /:
          root: dist
          index: [index.html]
          scripts: false
          expires: 24h
          rules:
            '\.(css|js|gif|jpe?g|png|svg|webp)$':
              expires: 4w

services:
  # No external services detected or required based on project files and dependencies

routes:
  https://{default}/:
    type: upstream
    upstream: frontend:http